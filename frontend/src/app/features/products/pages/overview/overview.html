<div class="overview-header">
  <app-filter [(filterText)]="filterText"></app-filter>
  <button routerLink="/products/create" class="btn-add">Agregar</button>
</div>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>Logo</th>
        <th
          (click)="toggleSort('name')"
          [ngClass]="{
            'sorted-asc': sortField() == 'name' && sortAsc(),
            'sorted-desc': sortField() == 'name' && !sortAsc(),
          }"
        >
          Nombre <i class="fa-solid fa-arrow-up-wide-short"></i>
        </th>
        <th
          (click)="toggleSort('description')"
          [ngClass]="{
            'sorted-asc': sortField() == 'description' && sortAsc(),
            'sorted-desc': sortField() == 'description' && !sortAsc(),
          }"
        >
          Descripción <i class="fa-solid fa-arrow-up-wide-short"></i>
        </th>
        <th
          (click)="toggleSort('date_release')"
          [ngClass]="{
            'sorted-asc': sortField() == 'date_release' && sortAsc(),
            'sorted-desc': sortField() == 'date_release' && !sortAsc(),
          }"
        >
          Fecha de liberación <i class="fa-solid fa-arrow-up-wide-short"></i>
        </th>
        <th
          (click)="toggleSort('date_revision')"
          [ngClass]="{
            'sorted-asc': sortField() == 'date_revision' && sortAsc(),
            'sorted-desc': sortField() == 'date_revision' && !sortAsc(),
          }"
        >
          Fecha de reestructuración <i class="fa-solid fa-arrow-up-wide-short"></i>
        </th>
        <th>Opciones</th>
      </tr>
    </thead>
    <tbody>
      @for(product of paginatedProducts; track product.id){
        <tr>
          <td><img [src]="product.logo" alt="{{ product.name }}" class="product-logo" loading="lazy" /></td>
          <td>{{ product.name }}</td>
          <td>{{ product.description }}</td>
          <td>{{ product.date_release }}</td>
          <td>{{ product.date_revision }}</td>
          <td>
            <app-actions-dropdown [product]="product" (reload)="removeProduct($event)"></app-actions-dropdown>
          </td>
        </tr>
      }
    </tbody>
  </table>

  @if(!loading() && products().length <= 0){
    <div class="empty">
      <span>No hay productos creado</span>
      <br>
      <span>Crea uno!</span>
    </div>
  }
</div>

<app-paginator
  [pageIndex]="pageIndex()"
  [pageSize]="pageSize()"
  [totalItems]="filteredProducts.length"
  (prev)="prevPage()"
  (next)="nextPage()"
  (pageSizeChange)="changePageSize($event)"
></app-paginator>

